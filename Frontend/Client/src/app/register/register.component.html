<form #registerForm="ngForm" (ngSubmit)="register()">
    <h2 class="text-center text-primary">Sign up</h2>
    <hr>
    <div class="row">
      <div class="col-md-6">
        <div class="mb-3 form-floating">
          <input
            type="text"
            class="form-control"
            name="firstName"
            [(ngModel)]="model.firstName"
            #firstName="ngModel"
            required
            placeholder="First Name"
          />
          <label>First Name</label>
          @if (firstName.invalid && (firstName.dirty || firstName.touched)) {
            <div class="text-danger">
              First Name is required.
            </div>
          }
        </div>
  
        <div class="mb-3 form-floating">
          <input
            type="email"
            class="form-control"
            name="email"
            [(ngModel)]="model.email"
            #email="ngModel"
            required
            email
            placeholder="Email"
          />
          <label>Email</label>
          @if (email.invalid && (email.dirty || email.touched)) {
            <div class="text-danger">
              @if (email.errors?.['required']) {
                Email is required.
              }
              @if (email.errors?.['email']) {
                Invalid email format.
              }
            </div>
          }
        </div>
  
        <div class="mb-3 form-floating">
          <input
            type="date"
            class="form-control"
            name="birthDate"
            [(ngModel)]="model.birthDate"
            #birthDate="ngModel"
            required
            placeholder="Birth Date"
          />
          <label>Birth Date</label>
          @if (birthDate.invalid && (birthDate.dirty || birthDate.touched)) {
            <div class="text-danger">
              Birth Date is required.
            </div>
          }
        </div>
      </div>
  
      <div class="col-md-6">
        <div class="mb-3 form-floating">
          <input
            type="text"
            class="form-control"
            name="lastName"
            [(ngModel)]="model.lastName"
            #lastName="ngModel"
            required
            placeholder="Last Name"
          />
          <label>Last Name</label>
          @if (lastName.invalid && (lastName.dirty || lastName.touched)) {
            <div class="text-danger">
              Last Name is required.
            </div>
          }
        </div>
  
        <div class="mb-3 form-floating position-relative">
            <input
              [type]="showPassword ? 'text' : 'password'"
              class="form-control"
              name="password"
              [(ngModel)]="model.password"
              #password="ngModel"
              required
              pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$"
              placeholder="Password"
            />
            <label>Password</label>
            <button type="button" 
            class="position-absolute end-0 top-50 translate-middle-y"
            style="width: 30px !important; height: 30px !important; padding: 0 !important; font-size: 18px !important; border-radius: 50% !important; display: flex; align-items: center; justify-content: center; border: none !important; background-color: transparent !important;" 
            (click)="togglePasswordVisibility()">
              <i class="bi" [ngClass]="showPassword ? 'bi-eye-slash' : 'bi-eye'"></i>
            </button>
           
          </div>    
  
        <div class="mb-3 form-floating">
          <input
            type="text"
            class="form-control"
            name="address"
            [(ngModel)]="model.address"
            #address="ngModel"
            required
            placeholder="Address"
          />
          <label>Address</label>
          @if (address.invalid && (address.dirty || address.touched)) {
            <div class="text-danger">
              Address is required.
            </div>
          }
        </div>
      </div>
    </div>
  
    <div class="mb-3 form-floating">
      <select class="form-select" name="tenantId" [(ngModel)]="model.tenantId" #tenantId="ngModel" required>
        @for (tenant of tenants; track tenant.id) {
          <option [value]="tenant.id">
            {{ tenant.name }}
          </option>
        }
      </select>
      <label>Select City</label>
      @if (tenantId.invalid && (tenantId.dirty || tenantId.touched)) {
        <div class="text-danger">
          Tenant selection is required.
        </div>
      }
    </div>
  
    <div class="mb-3">
      <label class="form-label">Upload Profile Image</label>
      <input type="file" class="form-control" (change)="onFileSelected($event)" />
    </div>
  
    <div class="form-group text-center">
      <button class="btn btn-success me-2" type="submit" [disabled]="registerForm.invalid">
        Register
      </button>
      <button class="btn btn-default me-2" type="button" (click)="cancel()">
        Cancel
      </button>
    </div>
  </form>
  @if (errorMessage) {
    <div class="alert alert-danger mt-2">
      {{ errorMessage }}
    </div>
  }
  @if (password.invalid && (password.dirty || password.touched)) {
    <div class="text-danger">
      @if (password.errors?.['required']) {
        Password is required.
      }
      @if (password.errors?.['pattern']) {
        Password must include at least one uppercase letter, one lowercase letter, one number, and one special character.
      }
    </div>
  }
  